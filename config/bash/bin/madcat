#!/usr/bin/env bash

# For real madlads.
__madcat() {
    local _path="$1"
    local bin

    bin=$(which cat)

    if which bat >/dev/null; then
        bin=$(which bat)
    fi

    if [[ $_path == *md ]]; then
        if which mdcat >/dev/null; then
            bin=$(which mdcat)
        fi
    fi

    if [[ $(file --mime-type -b "$_path" 2>/dev/null) == image/* ]]; then
        if which chafa >/dev/null; then
            bin=$(which chafa)
        fi

        if [[ "$TERM_PROGRAM" == 'WezTerm' ]]; then
            bin="$(which wezterm) imgcat"
        fi
    fi

    $bin "$@"
}

__madcat "$@"
